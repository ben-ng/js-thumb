<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: js-thumb.js</title>
    
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">
    
    <h1 class="page-title">Source: js-thumb.js</h1>
    
    


    
    <section>
        <article>
            <pre class="prettyprint source"><code>/**
 * Creates a new JSThumb object.
 * @constructor 
 */ 
 var jsthumb = function() {
  function err(msg) {
    if(window.console) {
      console.log(msg);
    }
  };
  
  /**
  * Capture a screenshot from a video
  * @param {Node} video - The video element in your DOM
  * @param {object} opts - Output options. e.g. {maxWidth:200, maxHeight:200, origWidth:400, origHeight:400}
  */
  function screenshot(video, opts) {
      var ctx
        , canvas = document.createElement('canvas');
      
      opts = opts || {};
      
      var origWidth = opts.origWidth || video.videoWidth;
      var origHeight = opts.origHeight || video.videoHeight;
      
      //Check for metadata not yet loaded
      if(!origWidth || !origHeight) {
        err("Video has invalid dimensions or metadata has not yet loaded.");
        return false;
      }
      
      canvas.width = origWidth;
      canvas.height = origHeight;
      
      ctx = canvas.getContext("2d");
      
      ctx.drawImage(video, 0, 0, origWidth, origHeight);
      
      return canvas.toDataURL("image/png");
  };
  
  /**
  * Thumbnails an image
  * @param {node} image - The image element in your DOM
  * @param {object} opts - Output options. e.g. {maxWidth:200, maxHeight:200, origWidth:400, origHeight:400}
  */
  function resize(image, opts) {
    var maxWidth = opts.maxWidth || 50
      , maxHeight = opts.maxHeight || 50
      , canvasOut = document.createElement('canvas')
      , canvasIn = document.createElement("canvas")
      , ctxOut = canvasOut.getContext("2d")
      , ctxIn = canvasIn.getContext("2d")
      , ratio = 1;
      
    var origWidth = opts.origWidth || image.width;
    var origHeight = opts.origHeight || image.height;
    
    //Limited by width
    if (origWidth > maxWidth) {
      ratio = maxWidth / origWidth;
    }
    //Limited by height
    else if (origHeight > maxHeight) {
      ratio = maxHeight / origHeight;
    }
    
    canvasIn.width = origWidth;
    canvasIn.height = origHeight;
    ctxIn.drawImage(image, 0, 0);
    
    canvasOut.width = origWidth * ratio;
    canvasOut.height = origHeight * ratio;
    ctxOut.drawImage(canvasIn, 0, 0, canvasIn.width, canvasIn.height, 0, 0, canvasOut.width, canvasOut.height);
    
    return canvasOut.toDataURL();
  };
  
  /**
  * Thumbnails base64 encoded image data
  * @param {string} imageData - Base64 encoded image data
  * @param {object} opts - Output options. e.g. {maxWidth:200, maxHeight:200, origWidth:400, origHeight:400}
  * @param {jsthumbCallback} cb - Called after processing is complete
  */
  function resizeData(imageData, opts, cb) {
    opts = opts || {};
    
    var image = new Image();
    
    image.onload = function()
    {
      cb(null, resize(image, opts));
    };
    
    image.src = imageData;
  };
  
  return {
    screenshot: screenshot
  , resize: resize
  , resizeData: resizeData
  };
  
  /**
   * This callback is displayed as a global member.
   * @callback jsthumbCallback
   * @param {null|string} err - null if no error
   * @param {string} data - Base64 Encoded Data
   */
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="jsthumb.html">jsthumb</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.0-dev</a> on Thu Jun 13 2013 17:17:08 GMT-0700 (PDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
